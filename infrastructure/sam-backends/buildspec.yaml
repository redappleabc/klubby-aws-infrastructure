version: 0.2

phases:
  build:
    commands:
      - cd infrastructure/sam-backends/add-new-user
      - sam build
      - sam deploy
        --stack-name add-new-user-function-$STAGE
        --s3-bucket klubby-$STAGE-artifacts-bucket
        --capabilities CAPABILITY_IAM
        --region us-east-1
        --no-fail-on-empty-changeset
        --parameter-overrides
            ParameterKey=Stage,ParameterValue=$STAGE
      - ls